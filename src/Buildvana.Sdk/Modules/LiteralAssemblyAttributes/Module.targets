<Project>

  <!-- Save the value of GenerateLiteralAssemblyInfo for later determination
       of whether to issue a warning. -->
  <PropertyGroup>
    <BV_GenerateLiteralAssemblyInfo>$(GenerateLiteralAssemblyInfo)</BV_GenerateLiteralAssemblyInfo>
  </PropertyGroup>

  <!-- Coalesce GenerateLiteralAssemblyInfo to a boolean value;
       force to false for projects in unsupported languages. -->
  <PropertyGroup>
    <GenerateLiteralAssemblyInfo Condition="'$(Language)' != 'C#' And '$(Language)' != 'VB'">false</GenerateLiteralAssemblyInfo>
    <GenerateLiteralAssemblyInfo Condition="'$(GenerateLiteralAssemblyInfo)' == ''">true</GenerateLiteralAssemblyInfo>
    <GenerateLiteralAssemblyInfo Condition="'$(GenerateLiteralAssemblyInfo)' != 'true'">false</GenerateLiteralAssemblyInfo>
  </PropertyGroup>

  <!-- Issue a warning if GenerateLiteralAssemblyInfo was set to true
       for a project in an unsupported language. -->
  <ItemGroup>
    <EvaluationWarning
      Condition="'$(BV_GenerateLiteralAssemblyInfo)' == 'true' And !$(GenerateLiteralAssemblyInfo)"
      Include="BVW1400"
      Text="Language '$(Language)' is not supported by LiteralAssemblyInfo." />
  </ItemGroup>

  <!-- Coalesce GenerateAssemblyCLSCompliantAttribute to a boolean value, defaulting to true. -->
  <PropertyGroup>
    <GenerateAssemblyCLSCompliantAttribute Condition="'$(GenerateAssemblyCLSCompliantAttribute)' == ''">true</GenerateAssemblyCLSCompliantAttribute>
    <GenerateAssemblyCLSCompliantAttribute Condition="'$(GenerateAssemblyCLSCompliantAttribute)' != 'true'">false</GenerateAssemblyCLSCompliantAttribute>
  </PropertyGroup>

  <!-- Coalesce GenerateAssemblyComVisibleAttribute to a boolean value, defaulting to true. -->
  <PropertyGroup>
    <GenerateAssemblyComVisibleAttribute Condition="'$(GenerateAssemblyComVisibleAttribute)' == ''">true</GenerateAssemblyComVisibleAttribute>
    <GenerateAssemblyComVisibleAttribute Condition="'$(GenerateAssemblyComVisibleAttribute)' != 'true'">false</GenerateAssemblyComVisibleAttribute>
  </PropertyGroup>

  <!-- Suppress warning CS3021: type or method does not need a CLSCompliant attribute because the assembly does not have a CLSCompliant attribute.
       The assembly actually has a CLSCompliant attribute; it's just that the IDE does not see it, because it's not in the source. -->
  <PropertyGroup Condition="'$(GenerateAssemblyCLSCompliantAttribute)' == 'true' And '$(CLSCompliant)' != ''">
    <NoWarn Condition="'$(NoWarn)' != ''">$(NoWarn);</NoWarn>
    <NoWarn>$(NoWarn)CS3021</NoWarn>
  </PropertyGroup>

  <!-- Generate CLSCompliant attribute. -->
  <ItemGroup Condition="'$(GenerateAssemblyCLSCompliantAttribute)' == 'true' And '$(CLSCompliant)' != ''">
    <LiteralAssemblyAttribute Include="System.CLSCompliant">
      <_Parameter1>$(CLSCompliant)</_Parameter1>
    </LiteralAssemblyAttribute>
  </ItemGroup>

  <!-- Generate ComVisible attribute. -->
  <ItemGroup Condition="'$(GenerateAssemblyComVisibleAttribute)' == 'true' And '$(ComVisible)' != ''">
    <LiteralAssemblyAttribute Include="System.Runtime.InteropServices.ComVisible">
      <_Parameter1>$(ComVisible)</_Parameter1>
    </LiteralAssemblyAttribute>
  </ItemGroup>

  <Import
    Project="$(MSBuildThisFileDirectory)Module.Core.targets"
    Condition="$(GenerateLiteralAssemblyInfo)" />

</Project>